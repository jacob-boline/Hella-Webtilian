{# hr_shop/templates/_product_detail_modal.html #}
{% load static shop_images %}

<div class="modal-product" data-product-slug="{{ product.slug }}">
  <div class="modal-product-media">
    {% if display_variant %}
        {% variant_image display_variant as modal_image %}
    {% else %}
        {% with product.variants.first as display_variant_fallback %}
            {% if display_variant_fallback %}
                {% variant_image display_variant_fallback as modal_image %}
            {% endif %}
        {% endwith %}
    {% endif %}

    {% if modal_image %}
        <img src="{{ modal_image.image.url }}"
             alt="{{ product.name }}"
             class="modal-image">
    {% else %}
        <img src="{% static 'hr_shop/img/placeholder_2.png' %}"
             alt="{{ product.name }}"
             class="modal-image">
    {% endif %}
  </div>

  <div class="modal-product-body">
    <h3 class="modal-title">{{ product.name }}</h3>

    {% if product.description %}
      <p class="modal-description">{{ product.description }}</p>
    {% endif %}

    {% if option_types %}
      <form id="product-options-form">
        {% for opt in option_types %}
          <div class="modal-variant-group">
            <label for="opt-{{ opt.code }}">{{ opt.name }}</label>
            <select id="opt-{{ opt.code }}"
                    name="opt_{{ opt.code }}"
                    class="modal-select"
                    data-option-type-id="{{ opt.id }}"
                    {% if opt.drives_image %}data-drives-image="1"{% endif %}>
              <option value="">Select {{ opt.name }}</option>
              {% for val in opt.values.all %}
                <option value="{{ val.id }}"
                        {% if opt.default_value_id == val.id %}selected{% endif %}>
                  {{ val.name }}
                </option>
              {% endfor %}
            </select>
          </div>
        {% endfor %}
      </form>
    {% endif %}

    <div class="modal-buttons">
      <button class="card-btn buy-cyan"
              data-product-id="{{ product.id }}"
              data-role="buy-selected-variant">
        <i class="fas fa-cart-plus"></i> Buy
      </button>

      <button class="card-btn outline" data-modal-close>
        Close
      </button>
    </div>
  </div>
</div>
