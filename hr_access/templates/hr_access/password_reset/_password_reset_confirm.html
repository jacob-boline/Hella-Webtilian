{# hr_access/templates/hr_access/password_reset/_password_reset_confirm.html #}

{% load form_fields %}

<div class="auth-modal checkout-details-modal modal-content">
    <div class="modal-scroll">
        <h2 class="sub-header">Set New Password</h2>

        {% if validlink %}
            <p class="auto-description">
                Enter your new password below.
            </p>

            {% include 'hr_common/_non_field_errors.html' %}

            <form id="password-reset-confirm-form"
                  method="post"
                  action=""
                  hx-post="{{ request.path }}"
                  hx-target="#modal-content"
                  hx-swap="innerHTML transition:true"
                  novalidate>
                {% csrf_token %}
                {% form_field form.new_password1 help="At least 8 characters, not entirely numeric." %}
                {% form_field form.new_password2 %}
                <div class="modal-actions grid grid-cols-1">
                    <button type="submit" class="card-btn btn-neon btn-green">
                        Reset Password
                    </button>
                </div>
            </form>

        {% else %}

            {# Invalid or expired link #}
            <div class="checkout-state auth-state-error">
                <div class="checkout-state-icon checkout-state-icon--error">
                    <i class="fa-solid fa-times-circle"></i>
                </div>
                <p class="checkout-message">
                    This password reset link is invalid or has expired.
                    Please request a new one.
                </p>
                <div class="modal-actions grid grid-cols-1">
                    <button type="button"
                            class="card-btn btn-neon btn-green"
                            hx-get="{% url 'hr_access:password_reset' %}"
                            hx-target="#modal-content"
                            hx-swap="innerHTML">
                        Request New Link
                    </button>
                </div>
            </div>

        {% endif %}
    </div>
</div>
