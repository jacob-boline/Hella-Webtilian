{#  templates/registration/_password_reset_confirm.html #}

{% load form_fields %}

<div class="auth-modal checkout-details-modal">
    <h2 class="sub-header">Set New Password</h2>

    {% if validlink %}
        <p class="auto-description">
            Enter your new password below.
        </p>

        {% include 'hr_common/_non_field_errors.html' %}

        <form id="password-reset-confirm-form" method="post" novalidate>
            {% csrf_token %}
            {% form_field form.new_password help="At least 8 characters, not entirely numeric." %}
            {% form_field form.new_password2 %}
            <div class="modal-actions">
                <button type="submit" class="card-btn buy-cyan">
                    Reset Password
                </button>
            </div>
        </form>

    {% else %}

        {# Invalid or expired link #}
        <div class="checkout-state auth-state-error">
            <div class="checkout-state-icon checkout-state-icon--error">
                <i class="fas fa-times-circle"></i>
            </div>
            <p class="checkout-message">
                This password reset link is invalid or has expired.
                Please request a new one.
            </p>
            <div class="modal-actions">
                <button type="button"
                        class="card-btn buy-cyan"
                        hx-get="{% url 'hr_access:password_reset' %}"
                        hx-target="#modal-content"
                        hx-swap="innerHTML">
                    Request New Link
                </button>
            </div>
        </div>

    {% endif %}
</div>