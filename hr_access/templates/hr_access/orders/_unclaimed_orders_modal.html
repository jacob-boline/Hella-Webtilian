{# hr_access/templates/hr_access/orders/_unclaimed_orders_modal.html #}

<div class="unclaimed-orders-modal modal-content">
    <div class="unclaimed-orders-layout">
        <h2 class="sub-header modal-title">Unclaimed orders</h2>

        {% if error %}
            <div class="form-errors">
                <p>{{ error }}</p>
            </div>
        {% endif %}

        {% if not email %}
            <p class="text-muted">No email found for your account.</p>
        {% else %}
            <p class="text-muted">
                Showing unclaimed orders associated with <strong>{{ email }}</strong>.
            </p>

            {% if unclaimed_orders %}
                <form hx-post="{% url 'hr_access:account_submit_claim_unclaimed_orders' %}"
                      hx-target="#modal-content"
                      hx-swap="none">

                    {% csrf_token %}

                    <div class="order-claim-list">
                        <div class="order-claim-header">
                            <input type="checkbox" id="select-all-unclaimed" aria-label="Select all orders">
                            <span class="order-id-header">ID</span>
                            <span>Date</span>
                            <span>Total</span>
                            <span class="payment-status-header">Payment</span>
                            <span class="order-status-header">Status</span>
                        </div>
                        {% for o in unclaimed_orders %}
                            <label class="order-claim-row">
                                <input type="checkbox"
                                       name="order_ids"
                                       value="{{ o.id }}"
                                       class="unclaimed-order-checkbox">
                                <span class="order-claim-id">#{{ o.id }}</span>
                                <span class="order-claim-meta">{{ o.created_at|date:"m/d/Y" }}</span>
                                <span class="order-claim-meta">${{ o.total|floatformat:2 }}</span>
                                <span class="order-claim-meta payment-status">{{ o.payment_status }}</span>
                                <span class="order-claim-meta order-status">{{ o.order_status }}</span>
                            </label>
                        {% endfor %}
                    </div>

                    <div class="modal-actions inline uniform grid grid-cols-1 lg:grid-cols-2">
                        <button type="submit" class="card-btn btn-neon btn-green btn-sm">Claim selected</button>
                        <button type="button"
                                class="card-btn btn-neon btn-blue btn-sm"
                                hx-get="{% url 'hr_access:account_get_unclaimed_orders' %}"
                                hx-target="#modal-content"
                                hx-swap="innerHTML transition:true">
                            View Your Orders
                        </button>
                    </div>
                </form>

            {% else %}
                <p class="text-muted">No unclaimed orders found for this email.</p>

                <div class="modal-actions stack uniform grid grid-cols-1">
                    <button type="button" class="card-btn btn-neon btn-blue btn-sm" data-modal-close>
                        Close
                    </button>
                </div>
            {% endif %}

        {% endif %}
    </div>
</div>
