(function(){const t={PARALLAX_SCROLL_RATIO:.5,BANNER_BUFFER:2,BANNER_STEP:5,BANNER_FADE_DISTANCE_VH:40,REDUCED_MOTION:window.matchMedia("(prefers-reduced-motion: reduce)").matches};function n(s,d=200){let c;return function(...l){clearTimeout(c),c=setTimeout(()=>s.apply(this,l),d)}}function a(){return window.visualViewport&&window.visualViewport.height?window.visualViewport.height:window.innerHeight||document.documentElement.clientHeight}window.hrSite=window.hrSite||{},window.hrSite.config=Object.assign({},window.hrSite.config||{},t),window.hrSite.utils=Object.assign({},window.hrSite.utils||{},{debounce:n,getVH:a})})();(function(){function e(t){const a=`; ${document.cookie}`.split(`; ${t}=`);if(a.length===2)return a.pop().split(";").shift()}document.body.addEventListener("htmx:configRequest",function(t){const n=e("csrftoken");n&&(t.detail.headers["X-CSRFToken"]=n)})})();(()=>{const e=()=>{const n=(window.visualViewport?.height??window.innerHeight)*.01;document.documentElement.style.setProperty("--vh",`${n}px`)};e(),window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",e),window.visualViewport?.addEventListener("resize",e,{passive:!0}),window.addEventListener("pageshow",n=>{n.persisted&&e()}),document.addEventListener("fullscreenchange",e);let t;["scroll","resize"].forEach(n=>{window.addEventListener(n,()=>{cancelAnimationFrame(t),t=requestAnimationFrame(e)},{passive:!0})})})();(function(){function e(){if(window.hrSite=window.hrSite||{},window.hrSite.__globalUiInitialized)return;window.hrSite.__globalUiInitialized=!0;const t=document.getElementById("modal"),n=document.getElementById("modal-content"),a=document.getElementById("modal-message-box"),s=document.getElementById("global-message-bar"),d=document.getElementById("global-message-content"),c=document.querySelector(".floating-cart-btn");let l=0;function o(){c&&c.classList.add("is-hidden")}function i(){c&&c.classList.remove("is-hidden")}function r(w,S=1e3){!s||!d||(d.textContent=w||"",s.classList.add("is-visible"),window.setTimeout(()=>{s.classList.remove("is-visible")},S))}function g(){const w=window.hrSite?.reflowParallax,S=window.hrSite?.syncActiveWipe,u=window.hrSite?.banner;requestAnimationFrame(()=>{requestAnimationFrame(()=>{typeof w=="function"&&w(),typeof S=="function"&&S(),typeof u?.setBannerState=="function"&&u.setBannerState(window.scrollY||0),typeof u?.updateFade=="function"&&u.updateFade()})})}function v(){if(!t)return;const w=window.scrollY;t.dataset.scrollY=w,t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),document.body.classList.add("modal-open"),document.body.style.top=`-${w}px`,o()}function L(){if(!t)return;const w=document.getElementById("nav-open-btn");w&&w.classList.remove("hidden");const S=parseInt(t.dataset.scrollY||"0",10);t.classList.add("hidden"),t.setAttribute("aria-hidden","true"),document.body.classList.remove("modal-open"),document.body.style.top="",window.scrollTo(0,S),g(),n&&n.replaceChildren(),a&&a.replaceChildren(),i()}if(t&&(document.addEventListener("click",w=>{const S=w.target.closest(".modal-backdrop"),u=w.target.closest("[data-modal-close]");!S&&!u||(w.preventDefault(),L())}),document.addEventListener("keydown",w=>{w.key==="Escape"&&!t.classList.contains("hidden")&&L()})),t&&(n||a)){let w=function(S){return S===n||S===a||S?.id==="modal-content"||S?.id==="modal-message-box"};var _=w;document.addEventListener("htmx:afterSwap",S=>{const u=S.target;u&&w(u)&&v()}),document.addEventListener("htmx:beforeSwap",S=>{const u=S.target;if(!u||!w(u))return;const m=S.detail||{},x=m.xhr;if(m.shouldSwap===!1)return;if(x&&x.status===204||!m.serverResponse||m.serverResponse.trim()===""){m.shouldSwap=!1;return}t.classList.add("is-swapping")}),document.addEventListener("htmx:afterSettle",S=>{const u=S.target;u&&w(u)&&t.classList.remove("is-swapping")})}document.body.addEventListener("htmx:beforeRequest",w=>{const u=w.target?.closest?.("[data-cta-dismiss]");if(!u)return;if(u.dataset.ctaDismissBypass==="1"){delete u.dataset.ctaDismissBypass;return}const m=u.closest("#post-purchase-account");m&&(m.classList.add("is-dismissing"),u.dataset.ctaDismissBypass="1",w.preventDefault(),window.setTimeout(()=>{window.htmx&&window.htmx.trigger(u,"click")},200))},!0);function A(){const w=document.getElementById("drawer-navigation"),S=document.getElementById("nav-open-btn"),u=document.getElementById("nav-close-btn");if(!w||!S)return;const m=()=>{const E=window.matchMedia("(max-width: 767.98px)").matches;w.classList.contains("show")||(w.classList.add("show"),S.classList.add("hidden")),E&&(document.body.classList.contains("drawer-open")||(l=window.scrollY||0,document.body.classList.add("drawer-open"),document.body.style.top=`-${l}px`))},x=()=>{const E=window.matchMedia("(max-width: 767.98px)").matches;w.classList.remove("show"),S.classList.remove("hidden"),E&&(document.body.classList.remove("drawer-open"),document.body.style.top="",window.scrollTo(0,l))};S.addEventListener("click",E=>{E.stopPropagation(),m()}),u&&u.addEventListener("click",E=>{E.stopPropagation(),x()}),document.addEventListener("keydown",E=>{E.key==="Escape"&&x()}),document.addEventListener("click",E=>{if(!w.classList.contains("show"))return;const I=w.contains(E.target),R=S.contains(E.target);!I&&!R&&x()})}function y(){const w=document.getElementById("modal-loader");if(!w)return!1;const S=new URLSearchParams(window.location.search),u=(S.get("modal")||"").trim(),m=(S.get("modal_url")||"").trim();if(!u||!window.htmx)return!1;let x=null;if(m||u==="password_reset"&&m||u==="email_change"&&m)x=m;else if(u==="email_confirmed")x="/shop/checkout/email-confirmation/success/";else if(u==="order_payment_result"){const E=(S.get("order_id")||"").trim(),I=(S.get("t")||"").trim();if(!E||!I)return!1;x=`/shop/order/${encodeURIComponent(E)}/payment-result/?t=${encodeURIComponent(I)}`}return x==null||(w.setAttribute("hx-get",x),window.htmx.process(w),window.htmx.trigger(w,"hr:loadModal"),window.setTimeout(()=>{try{const E=new URLSearchParams(window.location.search);E.delete("modal"),E.delete("order_id"),E.delete("t"),E.delete("modal_url"),E.delete("handoff");const I=E.toString(),R=window.location.pathname+(I?`?${I}`:"")+window.location.hash;window.history.replaceState({},"",R)}catch{}},0)),!0}function C(){return y()}C()||(document.addEventListener("htmx:load",()=>C(),{once:!0}),window.setTimeout(C,50)),A(),window.hrSite=window.hrSite||{},window.hrSite.hideModal=L,window.hrSite.showGlobalMessage=r,window.hrSite.cart=window.hrSite.cart||{},window.hrSite.cart.show=i,window.hrSite.cart.hide=o,window.hrModal={open:v,close:L}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()})();(function(){window.hrSite=window.hrSite||{};const e={setBannerState:function(){},setupRecolorObserver:function(){},updateFade:function(){}};window.hrSite.banner=e,document.addEventListener("DOMContentLoaded",()=>{const t=window.hrSite&&window.hrSite.config||{},a=(window.hrSite&&window.hrSite.utils||{}).getVH||(()=>window.innerHeight||document.documentElement.clientHeight),s=t.BANNER_BUFFER??2,d=t.BANNER_STEP??5,c=document.querySelector("#banner"),l=document.querySelector("#banner-scroller"),o=c?c.querySelectorAll(".banner-row > span"):[],i=document.querySelector("#section-wipe-0"),r={lastIndexHidden:-1,cartShown:null},g=document.getElementById("nav-open-btn"),v=document.getElementById("floating-cart-btn");let L=null;o.length&&o.forEach(u=>{u.classList.remove("is-visible","burn","is-fading","hidden-once"),u.style.opacity=""});function A(u){if(!o.length)return;const m=o[u];!m||m.classList.contains("burn")||(m.classList.remove("blink","is-fading","hidden-once"),m.classList.add("burn","is-visible"))}function y(u){if(!o.length)return;const m=o[u];!m||m.classList.contains("hidden-once")||(m.classList.add("hidden-once","is-fading"),m.classList.remove("is-visible"))}function C(u){if(!o.length)return;const m=typeof u=="number"?u:window.scrollY;let x=a();(!x||x<=0)&&(x=window.innerHeight||1);const E=Math.max(1,Math.floor(x/100)),I=Math.floor(m/(d*E))-s,R=l?l.offsetTop+l.offsetHeight:0;m<R&&(r.lastIndexHidden=-1);for(let M=0;M<o.length;M++)M<=I&&!o[M].classList.contains("is-visible")?A(M):M>I&&m-R>=E*M&&M>r.lastIndexHidden&&(y(M),r.lastIndexHidden=M)}function _(){if(!c||!i)return;const u=c.getBoundingClientRect(),m=i.getBoundingClientRect(),x=u.bottom,I=m.top-x,R=(u.height||1)*3;let M;if(I>=R?M=1:I<=0?M=0:M=I/R,c.style.opacity=M.toFixed(3),g||v){const D=1-M;if(g&&(g.style.opacity=D.toFixed(3)),v){v.style.opacity=D.toFixed(3);const h=D>.001;if(r.cartShown!==h){r.cartShown=h;const b=window.hrSite?.cart;b?.show&&b?.hide?h?b.show():b.hide():v.classList.toggle("is-hidden",!h)}}}}function w(){!i||!c||!o.length||L||(L=new IntersectionObserver(u=>{u.forEach(m=>{!m.isIntersecting&&m.boundingClientRect.top<0?(c.style.backgroundColor="rgba(0,0,0,1)",o.forEach(x=>{x.style.color="darkorange"})):(c.style.backgroundColor="",o.forEach(x=>{x.style.color=""}))})},{root:null,threshold:0,rootMargin:`-${c.offsetHeight||0}px 0px 0px 0px`}),L.observe(i))}e.setBannerState=C,e.setupRecolorObserver=w,e.updateFade=_,w();const S=window.scrollY;C(S),_()})})();(function(){let e=null,t=null,n=0;function a(i,...r){try{return typeof i=="function"?i(...r):void 0}catch(g){console.error("[events] handler error",g);return}}function s(i){return i?.detail??{}}function d(i){const r=i?.detail?.xhr;return!!r&&Number(r.status)===401}function c(i){window.htmx&&window.htmx.trigger(document.body,"authRequired",i||{})}function l(i){const r=i.detail||{};if(!r.xhr)return null;const v=r.elt,L=v?.getAttribute("hx-target")||v?.dataset?.hxTarget||null,A=v?.getAttribute("hx-swap")||v?.dataset?.hxSwap||null;return{verb:(r.verb||"GET").toUpperCase(),path:r.path||"",parameters:r.parameters||{},headers:r.headers||{},target:L||null,swap:A||null}}function o(){if(!t||!window.htmx)return;const i=t;if(t=null,!["GET","HEAD"].includes(i.verb)){a(window.hrSite?.showGlobalMessage,"Signed in. Please retry your last action.",5e3);return}const r={};i.target&&(r.target=i.target),i.swap&&(r.swap=i.swap),window.htmx.ajax(i.verb,i.path,{...r,values:i.parameters})}document.body.addEventListener("authSuccess",()=>{requestAnimationFrame(()=>{requestAnimationFrame(o)})}),document.body.addEventListener("htmx:responseError",i=>{if(!d(i))return;t=(i?.detail?.xhr)._hrIntent||e||null,a(window.hrSite?.hideModal),c({message:"Please sign in.",open_drawer:!0,focus:"#id_username"})}),document.body.addEventListener("htmx:configRequest",i=>{const r=l(i);r&&(i.detail.xhr._hrIntent=r,e=r)}),document.body.addEventListener("authRequired",i=>{const r=Date.now();if(r<n)return;n=r+400;const g=s(i),v=(typeof g=="string"?g:null)||g.message||g.text||"";v&&a(window.hrSite?.showGlobalMessage,v,g.duration||5e3),g.open_drawer&&(typeof window.hrSite?.openDrawer=="function"?a(window.hrSite?.openDrawer):document.body.classList.add("drawer-open"));const L=g.focus||"#id_username",A=()=>{const C=document.activeElement;if(!C)return!1;const _=(C.tagName||"").toLowerCase();return _==="input"||_==="textarea"||C.isContentEditable===!0},y=()=>{if(A())return;const C=document.querySelector(L)||document.getElementById(L.replace(/^#/,""));C&&typeof C.focus=="function"&&C.focus()};requestAnimationFrame(()=>{requestAnimationFrame(y)})}),document.body.addEventListener("showMessage",i=>{const r=s(i),g=r.duration||5e3,v=(typeof r=="string"?r:null)||r.message||r.text||"";v&&a(window.hrSite?.showGlobalMessage,v,g)}),document.body.addEventListener("closeModal",()=>{a(window.hrSite?.hideModal)}),document.body.addEventListener("updateCart",i=>{const r=s(i),g=Number(r.item_count??r.count??0),v=document.getElementById("floating-cart-count");v&&(v.textContent=String(g))}),document.body.addEventListener("variantPreviewUpdated",i=>{const r=s(i);if(!r)return;const g=document.querySelector(".modal-product");if(!g)return;const v=g.querySelector(".modal-image"),L=g.querySelector('[data-role="modal-price"]'),A=g.querySelector('[data-role="buy-selected-variant"]');v&&r.image_url&&(v.src=r.image_url),L&&r.price&&(L.textContent=`$${r.price}`),A&&r.variant_slug&&(A.setAttribute("hx-post",`/shop/cart/add/${r.variant_slug}/`),A.setAttribute("hx-swap","none"))}),document.body.addEventListener("accessChanged",()=>{const i=document.getElementById("sidebar-access");if(!i)return;const r=i.dataset.accessUrl;if(!r){console.warn("[events] #sidebar-access missing data-access-url");return}if(!window.htmx){console.warn("[events] htmx not found; cannot refresh sidebar access");return}window.htmx.ajax("GET",r,{target:"#sidebar-access",swap:"innerHTML"})})})();const H={force:!1,allowMarkup:!1,wrappedAttr:"data-hr-wrapped",preserveOriginal:!0,useNbspForSpaces:!0};function V(e){return e&&e.querySelectorAll?e:document}function $(e){for(let t=0;t<e.childNodes.length;t++)if(e.childNodes[t].nodeType===Node.ELEMENT_NODE)return!0;return!1}function z(e,t){return t.preserveOriginal&&e.dataset&&e.dataset.hrOriginalText!=null?e.dataset.hrOriginalText:(e.textContent||"").trim()}function Y(e,t,n){n.preserveOriginal&&e.dataset&&e.dataset.hrOriginalText==null&&(e.dataset.hrOriginalText=t)}function j(e,t){const n=t.wrappedAttr||H.wrappedAttr;return(e.getAttribute(n)||"").split(",").map(a=>a.trim()).filter(Boolean)}function G(e,t,n){const a=n.wrappedAttr||H.wrappedAttr,s=j(e,n);s.includes(t)||s.push(t),e.setAttribute(a,s.join(","))}function X(e,t,n){return j(e,n).includes(t)}function K(e,t){return e===" "&&t.useNbspForSpaces?" ":e}function J(e){return Object.assign({},H,e||{})}function ue(e,t,n={}){const a=J(n);V(e).querySelectorAll(t).forEach(d=>{if(!d)return;const c="letters";if(!a.force&&X(d,c,a)||!a.allowMarkup&&$(d))return;const l=z(d,a);if(l){Y(d,l,a),d.replaceChildren();for(const o of l){const i=document.createElement("span");i.className="letter",i.textContent=K(o,a),d.appendChild(i)}G(d,c,a)}})}function Q(e,t={}){const n=J(t);V(e).querySelectorAll(".date, .time").forEach(s=>{if(!s)return;const d=s.classList.contains("date")?"datetime-date":"datetime-time";if(!n.force&&X(s,d,n)||!n.allowMarkup&&$(s))return;const c=z(s,n);if(!c)return;Y(s,c,n);const l=s.classList.contains("date")?"date-char":"time-char";s.replaceChildren();for(const o of c){const i=document.createElement("span");i.className=l,i.textContent=K(o,n),s.appendChild(i)}G(s,d,n)})}function Z(e){Q(e)}(function(){function e(){return window.visualViewport?.height||window.innerHeight||document.documentElement.clientHeight}function t(l,o=200){let i;return function(...r){clearTimeout(i),i=setTimeout(()=>l.apply(this,r),o)}}function n(l,...o){typeof l=="function"&&l(...o)}function a(){const l=window.hrSite?.config||{},o=window.hrSite?.utils||{},i=window.hrSite?.banner||{};return{config:l,bannerAPI:i,getVH:o.getVH||e,debounce:o.debounce||t}}function s(l){const o=l.PARALLAX_SCROLL_RATIO??.5;return!!l.REDUCED_MOTION?0:o}function d(l){document.querySelectorAll(l).forEach(o=>{o.style.transform="translate3d(0,0,0)"})}function c(){const{config:l,bannerAPI:o,getVH:i,debounce:r}=a(),g=s(l),v=document.querySelectorAll(".section-wipe"),L=document.querySelectorAll(".parallax-section"),A=new Set,y={wipeData:new Map,activeWipe:null,rafId:null,rafLayout:null,observers:{wipe:null,section:null}};function C(){const f=i();L.forEach(p=>{const k=p.querySelector(".parallax-content"),T=p.querySelector(".parallax-background");if(!k||!T)return;const O=Math.max(k.getBoundingClientRect().height,f);p.style.height=`${O}px`,T.style.height=`${O}px`})}function _(){v.forEach(f=>{const p=f.nextElementSibling;if(p&&p.classList.contains("parallax-section")){const k=p.getBoundingClientRect().top+window.scrollY;f.style.top=`${k}px`}delete f.dataset.baseHeight})}function w(){const f=i();y.wipeData.clear(),v.forEach(p=>{const k=p.getBoundingClientRect(),T=k.height,O=(f+T)/f,F=k.top+window.scrollY+50;y.wipeData.set(p,{scrollSpeedRatio:O,wipeOffset:F})})}function S(f,p){const k=f.querySelector(".parallax-background");if(!k)return;const T=f.getBoundingClientRect().top+p;k.style.transform=`translate3d(0, ${(p-T)*g}px, 0)`}function u(f){g!==0&&A.size!==0&&A.forEach(p=>{S(p,f)})}function m(){if(!y.activeWipe)return;const f=y.wipeData.get(y.activeWipe);if(!f)return;const{scrollSpeedRatio:p,wipeOffset:k}=f,T=window.scrollY,O=i();if((T-k+O)/O<0)return;const le=(T-k+O)/p;y.activeWipe.style.transform=`translate3d(0, -${le}px, 0)`}function x(){m()}function E(f){const p=y.observers[f];p&&p.disconnect(),y.observers[f]=null}function I(){E("wipe"),y.observers.wipe=new IntersectionObserver(f=>{f.forEach(p=>{p.isIntersecting?(y.activeWipe=p.target,window.addEventListener("scroll",x,{passive:!0})):y.activeWipe===p.target&&(y.activeWipe=null,window.removeEventListener("scroll",x))})},{threshold:0}),v.forEach(f=>y.observers.wipe.observe(f))}function R(){E("section"),y.observers.section=new IntersectionObserver(f=>{f.forEach(p=>{const k=p.target;p.isIntersecting?(k.classList.add("in-view"),A.add(k)):(k.classList.remove("in-view"),A.delete(k))})},{threshold:0}),L.forEach(f=>y.observers.section.observe(f))}function M(f){n(o.setBannerState,f),n(o.updateFade)}function D(){y.rafId||(y.rafId=requestAnimationFrame(()=>{const f=window.scrollY;u(f),M(f),y.rafId=null}))}function h(){return document.body.classList.contains("modal-open")||document.body.classList.contains("drawer-open")}function b(){h()||y.rafLayout||(y.rafLayout=requestAnimationFrame(()=>{d(".parallax-background, .section-wipe"),C(),_(),w(),q(),y.activeWipe=null;const f=window.scrollY;u(f),n(o.setBannerState,f),n(o.updateFade),y.rafLayout=null}))}function q(){const f=i();let p=null;for(const k of v){const T=k.getBoundingClientRect();if(T.bottom>0&&T.top<f){p=k;break}}y.activeWipe=p,y.wipeData.size||w(),m()}const P=r(b,80);Q(document),ue(document,"#parallax-section-1 .act-name"),C(),_(),w(),I(),R();const B=window.scrollY;u(B),n(o.setBannerState,B),n(o.updateFade),n(o.setupRecolorObserver),window.addEventListener("scroll",D,{passive:!0}),window.addEventListener("resize",P),window.addEventListener("orientationchange",P),window.visualViewport?.addEventListener("resize",P),document.fonts?.ready?.then?.(b),window.addEventListener("load",b),window.hrSite=window.hrSite||{},window.hrSite.reflowParallax=b,window.hrSite.syncActiveWipe=q}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c()})();(function(){const e=["neon-sequence-a","neon-sequence-c","neon-sequence-d","neon-sequence-e","neon-sequence-f","neon-sequence-j"],t="neon-sequence-k";function a(o){if(Math.random()<.1&&t!==o)return t;const i=e.filter(r=>r!==o);return i[Math.floor(Math.random()*i.length)]}function s(o){const i=o.dataset.neonSeq||null,r=a(i);o.dataset.neonSeq=r,o.style.animationName=r}function d(o){o.dataset.neonSeq="",o.style.animationName="none",o.style.animationPlayState="paused"}function c(o){o._neonInitialized||(o._neonInitialized=!0,d(o),o.classList.add("neon-ready"),o.addEventListener("mouseenter",()=>{s(o),o.style.animationPlayState="running"}),o.addEventListener("animationiteration",()=>{o.matches(":hover")&&s(o)}),o.addEventListener("mouseleave",()=>{d(o)}))}function l(o=document){o.querySelectorAll(".act-name").forEach(c)}document.addEventListener("DOMContentLoaded",()=>l()),document.addEventListener("htmx:afterSwap",o=>l(o.target))})();function ee(e=document){const t=e.querySelector("#about-carousel");if(!t)return;t._carouselInstance?.destroy&&t._carouselInstance.destroy();const n=t.querySelector(".about-stage")||t,a=t.querySelector(".about-stage-img"),s=t.querySelector(".about-thumbs"),d=s?Array.from(s.querySelectorAll("button.about-thumb")):[],c=s?Array.from(s.querySelectorAll("li")):[],l=t.querySelector(".about-nav.prev"),o=t.querySelector(".about-nav.next"),i=t.querySelector(".thumbs-prev"),r=t.querySelector(".thumbs-next");if(!a||!d.length)return;const g=(h,b)=>(h%b+b)%b;function v(h,b){if(!h||!b)return;const q=b.getBoundingClientRect(),P=h.getBoundingClientRect(),f=b.scrollLeft+(P.left-q.left)-(q.width/2-P.width/2);b.scrollTo({left:f,behavior:"smooth"})}function L(h,b){let q=null,P=0;const B=p=>{!p.touches||!p.touches.length||(q=p.touches[0].clientX,P=Date.now())},f=p=>{if(q==null||!p.changedTouches||!p.changedTouches.length)return;const k=p.changedTouches[0].clientX-q,T=Date.now()-P;q=null,Math.abs(k)>40&&T<600&&b(k<0?"next":"prev")};return h.addEventListener("touchstart",B,{passive:!0}),h.addEventListener("touchend",f),()=>{h.removeEventListener("touchstart",B),h.removeEventListener("touchend",f)}}const A=d.length;let y=0,C=null,_=null;s&&s.setAttribute("role","tablist"),n.setAttribute("role","group"),d.forEach((h,b)=>{h.setAttribute("role","tab"),h.setAttribute("aria-selected","false"),h.setAttribute("tabindex","-1"),h.addEventListener("keydown",q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),m(b,!0)),q.key==="ArrowRight"&&(q.preventDefault(),m(b+1,!0)),q.key==="ArrowLeft"&&(q.preventDefault(),m(b-1,!0))})});function w(h){const b=d[h];if(!b)return null;const{src:q,alt:P}=b.dataset;return q?{src:q,alt:P||""}:null}function S(h){const b=w(h);!b||!b.src||(a.src=b.src,a.alt=b.alt||"")}function u(h){const b=d.length,q=g(h-1,b),P=g(h+1,b);if(d.forEach((B,f)=>{const p=f===h;B.classList.toggle("is-active",p),B.setAttribute("aria-selected",p?"true":"false"),B.setAttribute("tabindex",p?"0":"-1")}),c.length===d.length)c.forEach((B,f)=>{const p=f===h||f===q||f===P;B.classList.toggle("is-visible",p)});else{const B=d[h],f=B.closest("li")||B;v(f,s)}}function m(h,b=!1){A&&(y=g(h,A),S(y),u(y),b&&n.focus?.({preventScroll:!0}))}const x=h=>{if(!s)return;const b=s.clientWidth/3||100;s.scrollBy({left:h*b,behavior:"smooth"})},E=()=>{m(y-1,!0),x(-1)},I=()=>{m(y+1,!0),x(1)};d.forEach((h,b)=>{h.addEventListener("click",()=>m(b,!0))}),l&&l.addEventListener("click",E),o&&o.addEventListener("click",I),i&&i.addEventListener("click",()=>{m(y-1,!0),x(-1)}),r&&r.addEventListener("click",()=>{m(y+1,!0),x(1)});const R=h=>{h.key==="ArrowRight"&&(h.preventDefault(),I()),h.key==="ArrowLeft"&&(h.preventDefault(),E())};t.addEventListener("keydown",R),C=L(n,h=>{h==="next"?I():E()});const M=()=>u(y);window.addEventListener("resize",M),A>1&&(_=window.setInterval(()=>{m(y+1,!1)},4e3)),m(0,!1);const D={next:I,prev:E,go:h=>m(h,!0),destroy(){l&&l.removeEventListener("click",E),o&&o.removeEventListener("click",I),t.removeEventListener("keydown",R),window.removeEventListener("resize",M),C&&C(),_&&window.clearInterval(_)}};return t._carouselInstance=D,D}function te(e=document){const t=e.querySelector("#about-quotes");if(!t)return;t._quotesInstance?.destroy&&t._quotesInstance.destroy();const n=t.querySelector(".about-quote-rotator");if(!n)return;const a=n.querySelector(".quote-text"),s=n.querySelector(".quote-source"),d=t.querySelectorAll(".about-quote-data li");if(!a||!d.length)return;let c=0,l=null;function o(r){const g=d[r];if(!g)return;const v=g.dataset.text||"",L=g.dataset.source||"";a.textContent=v,s&&(s.textContent=L?`— ${L}`:"")}o(0),d.length>1&&(l=window.setInterval(()=>{c=(c+1)%d.length,o(c)},3456));const i={destroy(){l&&window.clearInterval(l)}};return t._quotesInstance=i,i}function ne(e=document){if(document.body._merchInitDone)return;document.body._merchInitDone=!0,document.addEventListener("click",n=>{const a=n.target.closest("button.merch-img, .merch-actions .card-btn.btn-blue");if(!a)return;const s=a.closest(".merch-card");if(!s)return;document.querySelectorAll(".merch-thumb-img.is-active, .modal-image.is-active").forEach(c=>c.classList.remove("is-active"));const d=s.querySelector(".merch-thumb-img");d&&d.classList.add("is-active")});function t(){const n=document.getElementById("modal");n&&n.classList.remove("hidden")}document.addEventListener("htmx:afterSwap",n=>{const a=n.detail;if(!a||!a.target||!a.target.closest("#modal"))return;const s=document.getElementById("modal");if(!s)return;const d=document.querySelector(".merch-thumb-img.is-active"),c=s.querySelector(".modal-image");if(!document.startViewTransition||!d||!c){t();return}document.startViewTransition(()=>{d.classList.remove("is-active"),c.classList.add("is-active"),t()})})}function fe(e){const t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?decodeURIComponent(t[2]):""}function me(){return new Promise((e,t)=>{if(window.Stripe)return e();const n=document.createElement("script");n.src="https://js.stripe.com/v3/",n.async=!0,n.onload=e,n.onerror=t,document.head.appendChild(n)})}function he(e=document){const t=e||document,n=t.getElementById?.("checkout-details-form")||t.querySelector?.("#checkout-details-form");if(!n||n._checkoutInitDone)return;n._checkoutInitDone=!0;const a=n.querySelector("#id_building_type")||n.querySelector('[name="building_type"]'),s=n.querySelector("#id_unit")||n.querySelector('[name="unit"]');if(!a||!s)return;const d=s.closest(".field-group");if(!d)return;const c=new Set(["apartment","business","other"]);function l(){const o=(a.value||"").trim();c.has(o)?d.classList.remove("hidden"):(d.classList.add("hidden"),s.value="",s.dispatchEvent(new Event("input",{bubbles:!0})),s.dispatchEvent(new Event("change",{bubbles:!0})))}a.addEventListener("change",l),l()}async function we(e=document){const t=e||document,n=t.getElementById?.("checkout-pay-root")||t.querySelector?.("#checkout-pay-root");if(!n||n._checkoutPayInitDone)return;n._checkoutPayInitDone=!0;const a=n.dataset.stripePublishableKey||"",s=n.dataset.clientSecret||"",d=n.dataset.sessionEndpoint||"";if(!a||!d){console.warn("checkout-pay: missing publishable key or session endpoint");return}const c=n.querySelector?.("[data-embedded-checkout]")||n.querySelector?.("#embedded-checkout");if(!c){console.warn("checkout-pay: missing embedded checkout mount element");return}if(c.dataset.stripeMounted==="1")return;try{await me()}catch(r){console.error("checkout-pay: failed to load Stripe.js",r),c.innerHTML="<p class='muted'>Payment UI failed to load. Please refresh.</p>";return}const l=window.Stripe;if(typeof l!="function"){console.warn("checkout-pay: Stripe.js loaded but window.Stripe is not a function"),c.innerHTML="<p class='muted'>Payment UI failed to load. Please refresh.</p>";return}const o=l(a),i=async()=>{if(s)return s;const r=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":fe("csrftoken"),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({}),credentials:"same-origin"});if(!r.ok){const v=await r.text().catch(()=>"");throw new Error(`checkout-pay: failed to create session (${r.status}) ${v}`)}const g=await r.json().catch(()=>({}));if(!g||!g.clientSecret)throw new Error("checkout-pay: no clientSecret returned");return g.clientSecret};try{(await o.initEmbeddedCheckout({fetchClientSecret:i})).mount(c),c.dataset.stripeMounted="1"}catch(r){console.error("checkout-pay: initEmbeddedCheckout failed",r),c.innerHTML="<p class='muted'>Payment UI failed to initialize. Please refresh or try again.</p>"}}function oe(e=document){he(e),we(e)}function re(){document.body._bulletinInitDone||(document.body._bulletinInitDone=!0,document.addEventListener("click",function(e){const t=e.target.closest(".bulletin-toggle");if(!t)return;const n=t.closest(".bulletin-post.is-collapsible");if(!n)return;const a=n.classList.toggle("is-expanded");n.classList.toggle("is-collapsed",!a);const s=t.querySelector(".bulletin-toggle-label");s&&(a?(s.firstChild&&(s.firstChild.textContent="Hide"),t.setAttribute("aria-expanded","true"),window.hrSite?.reflowParallax?.()):(s.firstChild&&(s.firstChild.textContent="Read more"),t.setAttribute("aria-expanded","false"),window.hrSite?.reflowParallax?.()))}))}function pe(e){return e?String(e).split(",").map(t=>t.trim()).filter(Boolean):[]}function ge(){const e=document.getElementById("modal");return!!e&&!e.classList.contains("hidden")&&e.getAttribute("aria-hidden")!=="true"}function be(e){return document.querySelector(e)}function ie(e=document){const n=(e||document).querySelectorAll?.("[data-hr-auto-advance]")||[];n.length&&n.forEach(a=>{if(a._hrAutoAdvanceInitDone)return;a._hrAutoAdvanceInitDone=!0;const s=parseInt(a.getAttribute("data-delay-ms")||"0",10)||0,d=a.getAttribute("data-next-url"),c=a.getAttribute("data-target")||"#modal-content",l=a.getAttribute("data-swap")||"innerHTML",o=pe(a.getAttribute("data-cancel-on"))||["click","keydown","submit"];if(!d||s<=0)return;const r=a.closest?.("#modal")||document;let g=!1,v=null;function L(){g=!0,v&&window.clearTimeout(v),v=null,o.forEach(A=>r.removeEventListener(A,L,!0))}o.forEach(A=>r.addEventListener(A,L,!0)),v=window.setTimeout(()=>{if(!(g||c==="#modal-content"&&!ge()||!be(c))){if(!window.htmx){console.warn("[auto-advance] htmx not available, cannot load:",d);return}window.htmx.ajax("GET",d,{target:c,swap:l}),L()}},s)})}const ve="hr_site_handoff_v1",N="BroadcastChannel"in window?new BroadcastChannel(ve):null;function ye(){const e=new URLSearchParams(window.location.search),t=e.get("handoff");return t?{type:t,hash:window.location.hash||"",modal:e.get("modal")||"",modalUrl:e.get("modal_url")||""}:null}function Se(){const e=window.location.pathname+window.location.hash;window.history.replaceState({},"",e)}function se(e=document){if(e!==document||!N)return;N.onmessage=c=>{const l=c.data||{};if(l.kind==="ping"){N.postMessage({kind:"pong",ts:Date.now()});return}if(l.kind==="handoff"&&l.payload){if(l.payload.hash){const o=document.querySelector(l.payload.hash);o&&o.scrollIntoView({behavior:"smooth",block:"start"})}if(l.payload.modal&&l.payload.url){const o=document.getElementById("modal-loader");if(!o||!window.htmx){console.warn("[tab-handoff] modal-loader or htmx missing in receiving tab");return}o.setAttribute("hx-get",l.payload.url),htmx.process(o),htmx.trigger(o,"hr:loadModal")}}};const t=ye();if(!t)return;let n=!1;const a=crypto?.randomUUID?.()||String(Date.now());N.postMessage({kind:"ping",pingId:a});const s=setTimeout(()=>{if(!n){if(t.modal&&t.modalUrl&&window.htmx){const c=document.getElementById("modal-loader");c&&(c.setAttribute("hx-get",t.modalUrl),htmx.process(c),htmx.trigger(c,"hr:loadModal"))}Se()}},250),d=c=>{(c.data||{}).kind==="pong"&&(n=!0,clearTimeout(s),N.postMessage({kind:"handoff",payload:{modal:t.modal,hash:t.hash,url:t.modalUrl}}),N.removeEventListener("message",d),window.close())};N.addEventListener("message",d)}const Ee={carouselModule:ee,quotesModule:te,merchModule:ne,checkoutModule:oe,bulletinModule:re,textModule:Z,autoAdvanceModule:ie,tabHandoff:se};function ae(){window.hrSite?.reflowParallax&&window.hrSite.reflowParallax()}function U(){window.hrSite?.reflowParallax&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.hrSite.reflowParallax(),window.dispatchEvent(new Event("scroll"))})})}function ce(e=document){Z(e),ee(e),te(e),ne(e),oe(e),re(),ie(e),se(e),ae()}function de(e){return e?e.id==="about-carousel-container"||e.id==="about-quotes-container"||e.id==="bulletin-root"||e.id==="modal-content"||e.id==="modal-message-box"||e.closest?.("#about-carousel-container")||e.closest?.("#about-quotes-container")||e.closest?.("#bulletin-root")||e.closest?.("#modal"):!1}function xe(e){return e?e.id==="modal-content"||e.closest?.("#modal"):!1}function W(){ce(document),U()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>W()):W();document.addEventListener("htmx:afterSwap",e=>{const t=e.target;de(t)&&(ce(t),xe(t)&&U())});document.addEventListener("htmx:afterSettle",e=>{const t=e.target;de(t)&&ae()});document.body.addEventListener("initModules",e=>{const t=e.detail||{},n=t.modules||t.module||t;(Array.isArray(n)?n:[n]).forEach(s=>{const d=Ee[s];if(!d){console.warn("[meta-init] unknown module:",s);return}d(document)}),t.reflow!==!1&&U()});
