{# hr_bulletin/templates/hr_bulletin/_post_card.html #}
{% load responsive_images %}
{# hr_bulletin/templates/hr_bulletin/_post_card.html #}

{% load responsive_images %}

<article class="bulletin-post {% if post.body|length > 260 %}is-collapsible is-collapsed{% endif %}">

    {% if post.hero %}
        <div class="bulletin-hero">
            <img src="{{ post.hero.url|post_hero_url:960 }}"
                 srcset="{{ post.hero.url|post_hero_srcset }}"
                 sizes="(max-width: 768px) 92vw, (max-width: 1200px) 80vw, 1100px"
                 alt="{{ post.title }}"
                 loading="lazy"
                 decoding="async">
        </div>
    {% endif %}

    <header class="bulletin-header">
        <h3 class="bulletin-title">
            <a href="{% url 'hr_bulletin:bulletin_detail' slug=post.slug  %}">
                {{ post.title }}
            </a>
        </h3>
        <div class="bulletin-meta">
            {% if post.publish_at %}
                <time datetime="{{ post.publish_at|date:'c' }}">
                    {{ post.publish_at|date:"M j, Y" }}
                </time>
            {% else %}
                <time datetime="{{ post.created_at|date:'c' }}">
                    {{ post.created_at|date:"M j, Y" }}
                </time>
            {% endif %}

            {% if post.tags.exists %}
                <span class="bulletin-tags">
                    {% for tag in post.tags.all %}
                        <span class="bulletin-tag">#{{ tag.name }}</span>
                    {% endfor %}
                </span>
            {% endif %}
        </div>

        {# --- Body preview / full text --- #}
        {% if post.body %}
            <div class="bulletin-body">
                <div class="bulletin-body-inner">
                    {{ post.body|linebreaksbr }}
                </div>

                {% if post.body|length > 260 %}
                    <button type="button"
                            class="bulletin-toggle"
                            aria-expanded="false">
                        <span class="bulletin-gradient"></span>
                        <span class="bulletin-toggle-label">
                            Read more
                        </span>
                    </button>
                {% endif %}
            </div>
        {% endif %}
    </header>
</article>
